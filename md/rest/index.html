<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>REST - Dino</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "REST";
    var mkdocs_page_input_path = "md/rest.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Dino</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../getting_started/">Getting Started</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../invisibility/">Invisibility</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../usage/">Usage</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../api/">API</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../web/">Web UI API</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../events/">Events</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../external_events/">External Events</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../acl/">ACL</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">REST</a>
    <ul class="current">
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../wio/">Who Is Online?</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../storage/">Storage</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Dino</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
    
    <li>REST</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h2 id="get-acl">GET acl</h2>
<p>Retrieve all ACLs for all non-temporary rooms in all channels.</p>
<p>Example response:</p>
<pre><code class="language-json">{
    &quot;data&quot;: {
        &quot;status&quot;: &quot;OK&quot;,
        &quot;data&quot;: {
            &quot;0efd8a52-7220-4160-88fe-68a15d470d95&quot;: [{
                &quot;type&quot;: &quot;admin&quot;,
                &quot;action&quot;: &quot;join&quot;,
                &quot;value&quot;: &quot;&quot;
            }, {
                &quot;type&quot;: &quot;admin&quot;,
                &quot;action&quot;: &quot;list&quot;,
                &quot;value&quot;: &quot;&quot;
            }],
            &quot;a81e4726-784a-11e9-bbdd-bbfdfd886868&quot;: [{
                &quot;type&quot;: &quot;gender&quot;,
                &quot;action&quot;: &quot;autojoin&quot;,
                &quot;value&quot;: &quot;m,f&quot;
            }]
        }
    },
    &quot;status_code&quot;: 200
}
</code></pre>
<h2 id="get-rooms">GET rooms</h2>
<p>Returns a list of all rooms currently existing. Result is cached for 1 minute and might thus not be always up-to-date.</p>
<p>Example response:</p>
<pre><code class="language-json">{
    &quot;data&quot;: [{
        &quot;name&quot;: &quot;default&quot;,
        &quot;status&quot;: &quot;static&quot;,
        &quot;id&quot;: &quot;2e7d537e-bed5-47c5-a7f6-357075759e5d&quot;,
        &quot;channel&quot;: &quot;App and Web&quot;
    }, {
        &quot;name&quot;: &quot;default1&quot;,
        &quot;status&quot;: &quot;static&quot;,
        &quot;id&quot;: &quot;2ddd90ac-1d44-4af5-9c7d-b9191bc35675&quot;,
        &quot;channel&quot;: &quot;App only&quot;
    }, {
        &quot;name&quot;: &quot;default2&quot;,
        &quot;status&quot;: &quot;temporary&quot;,
        &quot;id&quot;: &quot;6418dff0-43fc-469a-8f3b-724d3a5dcecf&quot;,
        &quot;channel&quot;: &quot;Web only&quot;
    }],
    &quot;status_code&quot;: 200
}
</code></pre>
<h2 id="get-rooms-acl">GET rooms-acl</h2>
<p>Returns a list of all rooms currently existing, that a specific user is 
allowed to join (if a user is not allowed to list a channel, no rooms 
from that channel will be included either). Result is cached for 1 
minute per user id and might thus not be always up-to-date.</p>
<p>Request:</p>
<pre><code class="language-json">{
    &quot;user_id&quot;: &quot;1234&quot;
}
</code></pre>
<p>Response:</p>
<pre><code class="language-json">{
    &quot;data&quot;: [{
        &quot;status&quot;: &quot;static&quot;,
        &quot;room_id&quot;: &quot;2e7d537e-bed5-47c5-a7f6-357075759e5d&quot;,
        &quot;users&quot;: 0,
        &quot;room_name&quot;: &quot;default&quot;,
        &quot;channel_id&quot;: &quot;7e1beff2-3d4f-40cc-baa5-f1fd79cc59c0&quot;,
        &quot;channel_name&quot;: &quot;App and Web&quot;
    }, {
        &quot;status&quot;: &quot;static&quot;,
        &quot;room_id&quot;: &quot;2ddd90ac-1d44-4af5-9c7d-b9191bc35675&quot;,
        &quot;users&quot;: 0,
        &quot;room_name&quot;: &quot;default1&quot;,
        &quot;channel_id&quot;: &quot;9613fbb5-5eaf-41b1-8480-0b364af04b80&quot;,
        &quot;channel_name&quot;: &quot;App only&quot;
    }, {
        &quot;status&quot;: &quot;static&quot;,
        &quot;room_id&quot;: &quot;6418dff0-43fc-469a-8f3b-724d3a5dcecf&quot;,
        &quot;users&quot;: 0,
        &quot;room_name&quot;: &quot;default2&quot;,
        &quot;channel_id&quot;: &quot;a37a51f0-48ed-43ba-9fcb-750ce7ee3fdb&quot;,
        &quot;channel_name&quot;: &quot;Web only&quot;
    }],
    &quot;status_code&quot;: 200
}
</code></pre>
<h2 id="post-acl">POST acl</h2>
<p>Request:</p>
<pre><code class="language-json">{
    &quot;room_id&quot;: &quot;a81e4726-784a-11e9-bbdd-bbfdfd886868&quot;,
    &quot;action&quot;: &quot;autojoin&quot;,
    &quot;acl_type&quot;: &quot;gender&quot;,
    &quot;acl_value&quot;: &quot;age=35,(gender=f|membership=normal)&quot;
}
</code></pre>
<p>For more examples on the format of the <code>acl_value</code> field, see the <a href="../acl/">ACL</a> section. </p>
<p>Response:</p>
<pre><code class="language-json">{
    &quot;data&quot;: {
        &quot;status&quot;: &quot;OK&quot;
    }, 
    &quot;status_code&quot;: 200
}
</code></pre>
<h2 id="get-history">GET history</h2>
<p>Request contains info on what time slice, target, origin to get history for:</p>
<pre><code class="language-json">{
    &quot;from_time&quot;: &quot;2016-12-26T08:39:54Z&quot;,
    &quot;to_time&quot;: &quot;2016-12-28T08:39:54Z&quot;,
    &quot;user_id&quot;: &quot;124352&quot;,
    &quot;room_id&quot;: &quot;dedf878e-b25d-4713-8058-20c6f0547c59&quot;
}
</code></pre>
<p>History can also be queried by <code>room_name</code> (base64):</p>
<pre><code class="language-json">{
    &quot;from_time&quot;: &quot;2016-12-26T08:39:54Z&quot;,
    &quot;to_time&quot;: &quot;2016-12-28T08:39:54Z&quot;,
    &quot;user_id&quot;: &quot;124352&quot;,
    &quot;room_name&quot;: &quot;MTY4Mjk5MDgxOQ==&quot;
}
</code></pre>
<p>If pagination is required, use only <code>to_time</code> and <code>limit</code>, together with either <code>room_id</code> or <code>room_name</code>:</p>
<pre><code class="language-json">{
    &quot;to_time&quot;: &quot;2023-05-19T08:39:54Z&quot;,
    &quot;room_name&quot;: &quot;MTY4Mjk5MDgxOQ==&quot;,
    &quot;limit&quot;: 50
}
</code></pre>
<p>For the next page of messages, use the <code>timestamp</code> of the oldest message in the response as the <code>to_time</code> parameter in 
the next request, the querying is exclusive of the <code>to_time</code> (strictly <code>timestamp &lt; to_time</code>).</p>
<p>Response would be something similar to the following:</p>
<pre><code class="language-json">    {
        &quot;status_code&quot;: 200,
        &quot;data&quot;: [{
            &quot;deleted&quot;: false,
            &quot;target_name&quot;: &quot;YmFkIGtpZHo=&quot;,
            &quot;target_id&quot;: &quot;675eb2a5-17c6-45e4-bc0f-674241573f22&quot;,
            &quot;timestamp&quot;: &quot;2017-01-26T04:58:33Z&quot;,
            &quot;from_user_name&quot;: &quot;YmF0bWFu&quot;,
            &quot;message_id&quot;: &quot;37db81f2-4e16-4076-b759-8ce1c23a364e&quot;,
            &quot;from_user_id&quot;: &quot;997110&quot;,
            &quot;channel_name&quot;: &quot;U2hhbmdoYWk=&quot;,
            &quot;body&quot;: &quot;aG93IGFyZSB5b3U/&quot;,
            &quot;domain&quot;: &quot;room&quot;,
            &quot;channel_id&quot;: &quot;dedf878e-b25d-4713-8058-20c6f0547c59&quot;
        }, {
            &quot;deleted&quot;: false,
            &quot;target_name&quot;: &quot;YmFkIGtpZHo=&quot;,
            &quot;target_id&quot;: &quot;675eb2a5-17c6-45e4-bc0f-674241573f22&quot;,
            &quot;timestamp&quot;: &quot;2017-01-26T04:58:31Z&quot;,
            &quot;from_user_name&quot;: &quot;YmF0bWFu&quot;,
            &quot;message_id&quot;: &quot;416d3c60-7197-471c-a706-7dbeca090d11&quot;,
            &quot;from_user_id&quot;: &quot;997110&quot;,
            &quot;channel_name&quot;: &quot;U2hhbmdoYWk=&quot;,
            &quot;body&quot;: &quot;aGVsbG8gdGhlcmU=&quot;,
            &quot;domain&quot;: &quot;room&quot;,
            &quot;channel_id&quot;: &quot;dedf878e-b25d-4713-8058-20c6f0547c59&quot;
        }, {
            &quot;deleted&quot;: false,
            &quot;target_name&quot;: &quot;YmFkIGtpZHo=&quot;,
            &quot;target_id&quot;: &quot;675eb2a5-17c6-45e4-bc0f-674241573f22&quot;,
            &quot;timestamp&quot;: &quot;2017-01-26T04:58:16Z&quot;,
            &quot;from_user_name&quot;: &quot;YmF0bWFu&quot;,
            &quot;message_id&quot;: &quot;91655457-3712-4c2f-b6f2-c3b0f8be29e5&quot;,
            &quot;from_user_id&quot;: &quot;997110&quot;,
            &quot;channel_name&quot;: &quot;U2hhbmdoYWk=&quot;,
            &quot;body&quot;: &quot;ZmRzYQ==&quot;,
            &quot;domain&quot;: &quot;room&quot;,
            &quot;channel_id&quot;: &quot;dedf878e-b25d-4713-8058-20c6f0547c59&quot;
        }]
    }
</code></pre>
<ul>
<li>If neither <code>from_time</code> nor <code>to_time</code> is specified, the last 7 days will be used,</li>
<li>If <code>from_time</code> is specified but no <code>to_time</code>, <code>to_time</code> will be <code>from_time + 7 days</code>,</li>
<li>If <code>to_time</code> is specified but no <code>from_time</code>, <code>from_time</code> will be <code>to_time - 7 days</code>,</li>
<li>Either <code>user_id</code> or <code>room_id</code>/<code>room_name</code> is required (both can be specified at the same time),</li>
<li><code>to_time</code> needs to be after <code>from_time</code>,</li>
<li>if <code>limit</code> is used, the <code>from_time</code> and <code>user_id</code> parameters are ignored.</li>
</ul>
<h2 id="post-heartbeat">POST heartbeat</h2>
<p>For mobile clients, it is sometimes tricky to maintain a constant connection due to fluctuations in network quality 
and data loss. To keep a user in an online state without keeping a connection open, the <code>/heartbeat</code> api can be used
instead.</p>
<p>With regular <code>/heartbeat</code> calls, a user will not be marked as offline until no more heartbeats are being received.</p>
<p>Multiple user IDs can be batched together into a single <code>/heartbeat</code> call.</p>
<p>Request:</p>
<pre><code class="language-json">[
    &quot;&lt;user ID 1&gt;&quot;,
    &quot;&lt;user ID 2&gt;&quot;,
    &quot;&lt;user ID n&gt;&quot;
]
</code></pre>
<p>Response:</p>
<pre><code class="language-json">{
    &quot;data&quot;: {
        &quot;status&quot;: &quot;OK&quot;
    }, 
    &quot;status_code&quot;: 200
}
</code></pre>
<h2 id="post-full-history">POST full-history</h2>
<p>To get all messages sent by a user, call this endpoint with the following data:</p>
<pre><code class="language-json">{
    &quot;user_id&quot;: 1971
    &quot;from_time&quot;: &quot;2016-12-26T08:39:54Z&quot;, # optional (other needed if this one is specified)
    &quot;to_time&quot;: &quot;2016-12-28T08:39:54Z&quot; # optional  (other needed if this one is specified)
}
</code></pre>
<p>Response looks like this:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200,
    &quot;data&quot;: [{
        &quot;message_id&quot;: &quot;07bacdd8-42e6-4ace-acee-8d200dd14bfc&quot;,
        &quot;from_user_id&quot;: &quot;1971&quot;,
        &quot;from_user_name&quot;: &quot;Um9k=&quot;,
        &quot;target_id&quot;: &quot;7935a673-da64-4419-818b-e6e0d1864b61&quot;,
        &quot;target_name&quot;: &quot;TG9iYnk=&quot;,
        &quot;body&quot;: &quot;eyJtYXNrIjoiMDAiLCJ6IjE2IiwidGV4dCI6ImkgYW0gaW52aXNpYmxlIn0=&quot;,
        &quot;domain&quot;: &quot;room&quot;,
        &quot;channel_id&quot;: &quot;84ec4b4f-7482-48ba-83a1-9c9b1c470903&quot;,
        &quot;channel_name&quot;: &quot;UGVu&quot;,
        &quot;timestamp&quot;: &quot;2017-05-23T07:32:07Z&quot;,
        &quot;deleted&quot;: true
    }, {...}]
}
</code></pre>
<h2 id="post-broadcast">POST broadcast</h2>
<p>Broadcasts a message to everyone on the server. Request needs the <code>body</code> and <code>verb</code> keys:</p>
<pre><code class="language-json">{
    &quot;body&quot;: &quot;aGkgdGhlcmU=&quot;,
    &quot;verb&quot;: &quot;broadcast&quot;
}
</code></pre>
<p>Body needs to be in base64. The verb may be anything, it's up to clients to handle it.</p>
<p>It's also possible to broadcast to only a single room, by specifying a <code>room_name</code> (in base64):</p>
<pre><code class="language-json">{
    &quot;body&quot;: &quot;aGkgdGhlcmU=&quot;,
    &quot;verb&quot;: &quot;broadcast&quot;,
    &quot;room_name&quot;: &quot;ZGU=&quot;
}
</code></pre>
<p>Event sent to clients:</p>
<pre><code class="language-json">{
    &quot;content&quot;: &quot;aGkgdGhlcmU=&quot;,
    &quot;published&quot;: &quot;2021-11-22T02:48:38Z&quot;,
    &quot;target&quot;: {
        &quot;id&quot;: &quot;0c643854-4b3d-11ec-b5c8-1325d666ae4c&quot;,
        &quot;objectType&quot;: &quot;room&quot;,
        &quot;displayName&quot;: &quot;ZGU=&quot;
    },
    &quot;id&quot;: &quot;2fd3c08a-62d1-46c3-96d7-b181264f6bcb&quot;,
    &quot;verb&quot;: &quot;broadcast&quot;,
    &quot;actor&quot;: {
        &quot;id&quot;: &quot;0&quot;,
        &quot;displayName&quot;: &quot;QWRtaW4=&quot;
    },
    &quot;provider&quot;: {
        &quot;id&quot;: &quot;foobar&quot;
    }
}
</code></pre>
<p>Note, if no <code>room_name</code> is specified, there's no <code>target</code> in the above event to clients.</p>
<h2 id="post-blacklist">POST blacklist</h2>
<p>Add a new word to the blacklist. Encode the word in base64 first, then post a request on the following format:</p>
<pre><code class="language-json">{
    &quot;word&quot;: &quot;YmFkd29yZA==&quot;
}
</code></pre>
<p>Response if OK:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200
}
</code></pre>
<h2 id="delete-blacklist">DELETE blacklist</h2>
<p>Remove a matching word from the blacklist. Encode the word in base64 first, then post a request on the following format:</p>
<pre><code class="language-json">{
    &quot;word&quot;: &quot;YmFkd29yZA==&quot;
}
</code></pre>
<p>The sent word will be compared lowercase to find  matching lowercased word in the blacklist and remove all words with
and exact match (when both lowercase).</p>
<p>Response if OK:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200
}
</code></pre>
<h2 id="post-set-admin">POST set-admin</h2>
<p>Set a user as a global moderator.</p>
<p>Request contains user ID and the user's name (in case the user doesn't exist):</p>
<pre><code class="language-json">{
    &quot;id&quot;: &quot;1234&quot;,
    &quot;name&quot;: &quot;myuser&quot;
}
</code></pre>
<p>Response if OK:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200
}
</code></pre>
<p>Or if any errors:</p>
<pre><code class="language-json">{
    &quot;data&quot;: &quot;no name parameter in request&quot;, 
    &quot;status_code&quot;: 500
}
</code></pre>
<h2 id="post-remove-admin">POST remove-admin</h2>
<p>Remove global moderator status for a user.</p>
<p>Request contains the user's ID only:</p>
<pre><code class="language-json">{
    &quot;id&quot;: &quot;1234&quot;
}
</code></pre>
<p>Response if OK:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200
}
</code></pre>
<p>Or if any errors:</p>
<pre><code class="language-json">{
    &quot;data&quot;: &quot;no id parameter in request&quot;, 
    &quot;status_code&quot;: 500
}
</code></pre>
<h2 id="post-ban">POST ban</h2>
<p>Request contains info on who to ban where. For banning globally:</p>
<pre><code class="language-json">{
    &quot;1234&quot;: {
        &quot;duration&quot;: &quot;24h&quot;,
        &quot;reason&quot;: &quot;&lt;optional base64 encoded free-text&gt;&quot;,
        &quot;admin_id&quot;: &quot;&lt;id of user banning (must already exist), or leave empty for default&gt;&quot;,
        &quot;type&quot;: &quot;global&quot;,
        &quot;name&quot;: &quot;&lt;username in base64, optional&gt;&quot;
    }
}
</code></pre>
<p>Can also ban multiple users at the same time:</p>
<pre><code class="language-json">{
    &quot;&lt;user id&gt;&quot;: {
        &quot;duration&quot;: &quot;24h&quot;,
        &quot;type&quot;: &quot;global&quot;,
        &quot;reason&quot;: &quot;&lt;option reason field, base64 encoded&gt;&quot;,
        &quot;admin_id&quot;: &quot;&lt;optional id of admin user who is banning&gt;&quot;,
        &quot;name&quot;: &quot;&lt;username in base64, optional&gt;&quot;
    },
    &quot;&lt;user id&gt;&quot;: {
        &quot;duration&quot;: &quot;10m&quot;,
        &quot;target&quot;: &quot;&lt;channel uuid&gt;&quot;,
        &quot;type&quot;: &quot;channel&quot;,
        &quot;reason&quot;: &quot;&lt;option reason field, base64 encoded&gt;&quot;,
        &quot;admin_id&quot;: &quot;&lt;optional id of admin user who is banning&gt;&quot;
    },
    &quot;&lt;user id&gt;&quot;: {
        &quot;duration&quot;: &quot;7d&quot;,
        &quot;target&quot;: &quot;&lt;room uuid&gt;&quot;,
        &quot;type&quot;: &quot;room&quot;,
        &quot;reason&quot;: &quot;&lt;option reason field, base64 encoded&gt;&quot;,
        &quot;admin_id&quot;: &quot;&lt;optional id of admin user who is banning&gt;&quot;
    }
}
</code></pre>
<p>For banning as user in a room, you can either use <code>"target": "&lt;room uuid&gt;"</code>, <code>"room_id": "&lt;room_uuid&gt;"</code> or 
<code>"room_name": "&lt;room name in base64&gt;"</code> (if using <code>room_name</code>, the room must be in the default channel, which is true
for all rooms created using the <code>/create</code> API).</p>
<p>The <code>name</code> field must be base64 encoded. The field is also optional and is only used if a ban request is received for 
a user that doesn't exist on the server, e.g. if the user never logged in before it will not exist. If the name is 
not specified, and the user has to be created before banning, the user ID will be set as the name (later when the user 
login the real username will overwrite this).</p>
<p>The <code>reason</code> field must be base64 encoded. If the <code>admin_id</code> field is specified it will be used, if not the default ID
<code>0</code> will be used (the default admin user).</p>
<p>Duration is an integer followed by a char for the unit, which can be one of <code>d</code>, <code>h</code>, <code>m</code>, <code>s</code> (days, hours, minutes, 
seconds). Negative or 0 durations are not allowed.</p>
<p>When type is set to <code>global</code>, no target is specified (meaning user is banned from the whole chat server).</p>
<p>Response will be something like the following (if failure):</p>
<pre><code class="language-json">{
    &quot;status&quot;: &quot;FAIL&quot;,
    &quot;message&quot;: &quot;missing target id for user id &lt;user id&gt; and request &lt;the request json&gt;&quot;
}
</code></pre>
<p>The banning is done async so if any of the provided user bans has invalid parameters the response will only tell you the
first non-valid parameter and for which user ID.</p>
<p>For success the response looks like this:</p>
<pre><code class="language-json">{
    &quot;status&quot;: &quot;OK&quot;
}
</code></pre>
<h2 id="delete-ban">DELETE ban</h2>
<p>To remove a ban in a room using the room name, send the following request:</p>
<pre><code class="language-json">{
  &quot;user_id&quot;: &quot;1234&quot;,
  &quot;room_name&quot;: &quot;&lt;room name in base64&gt;&quot;
}
</code></pre>
<p>To remove a ban in a room using the room ID, send the following request:</p>
<pre><code class="language-json">{
  &quot;user_id&quot;: &quot;1234&quot;,
  &quot;room_id&quot;: &quot;&lt;room uuid&gt;&quot;
}
</code></pre>
<p>To remove a global ban, send the following request:</p>
<pre><code class="language-json">{
  &quot;user_id&quot;: &quot;1234&quot;,
  &quot;global&quot;: true
}
</code></pre>
<p>If successful, the response looks like this:</p>
<pre><code class="language-json">{
  &quot;status_code&quot;: 200,
  &quot;data&quot;: {
    &quot;status&quot;: &quot;OK&quot;
  }
}
</code></pre>
<p>If the request fails (room name doesn't exist, invalid json, etc.), the response will look like this:</p>
<pre><code class="language-json">{
  &quot;status_code&quot;: 500,
  &quot;data&quot;: {
    &quot;status&quot;: &quot;FAIL&quot;,
    &quot;message&quot;: &quot;no room exists with name: &lt;the room name in the request&gt;&quot;
  }
}
</code></pre>
<h2 id="post-kick">POST kick</h2>
<p>Request contains:</p>
<pre><code class="language-json">{
    &quot;&lt;user id&gt;&quot;: {
        &quot;target&quot;: &quot;&lt;room uuid&gt;&quot;,
        &quot;reason&quot;: &quot;&lt;option reason field, base64 encoded&gt;&quot;,
        &quot;admin_id&quot;: &quot;&lt;optional id of admin user who is kicking&gt;&quot;
    },
    &quot;&lt;user id&gt;&quot;: {
        &quot;target&quot;: &quot;&lt;room uuid&gt;&quot;,
        &quot;reason&quot;: &quot;&lt;option reason field, base64 encoded&gt;&quot;,
        &quot;admin_id&quot;: &quot;&lt;optional id of admin user who is kicking&gt;&quot;
    },
    &quot;&lt;user id&gt;&quot;: {
        &quot;target&quot;: &quot;&lt;room uuid&gt;&quot;,
        &quot;reason&quot;: &quot;&lt;option reason field, base64 encoded&gt;&quot;,
        &quot;admin_id&quot;: &quot;&lt;optional id of admin user who is kicking&gt;&quot;
    }
}
</code></pre>
<p>The "reason" field must be base64 encoded. If the "admin_id" field is specified it will be used, if not the default ID
"0" will be used.</p>
<p>Response will be something like the following:</p>
<pre><code class="language-json">{
    &quot;&lt;user id&gt;&quot;: {
        &quot;status&quot;: &quot;OK&quot;
    },
    &quot;&lt;user id&gt;&quot;: {
        &quot;status&quot;: &quot;FAIL&quot;,
        &quot;message&quot;: &quot;no such user&quot;
    },
    &quot;&lt;user id&gt;&quot;: {
        &quot;status&quot;: &quot;OK&quot;
    }
}
</code></pre>
<h2 id="get-roles">GET roles</h2>
<p>Request contains a list of user IDs, e.g.:</p>
<pre><code class="language-json">{
    &quot;users&quot;: [
        &quot;124352&quot;,
        &quot;5678&quot;
    ]
}
</code></pre>
<p>Response would be something similar to the following:</p>
<pre><code class="language-json">{
    &quot;data&quot;: {
        &quot;124352&quot;: {
            &quot;room&quot;: {
                &quot;1aa3f5f5-ba46-4aca-999a-978c7f2237c7&quot;: [
                    &quot;moderator&quot;
                ],
                &quot;bb0ea500-cd94-11e6-b178-8323deb605bf&quot;: [
                    &quot;owner&quot;
                ]
            },
            &quot;channel&quot;: {
                &quot;dedf878e-b25d-4713-8058-20c6f0547c59&quot;: [
                    &quot;admin&quot;, 
                    &quot;owner&quot;
                ]
            },
            &quot;global&quot;: [
                &quot;superuser&quot;,
                &quot;globalmod&quot;
            ]
        },
        &quot;5678&quot;: {
            &quot;room&quot;: {},
            &quot;channel&quot;: {},
            &quot;global&quot;: []
        }
    },
    &quot;status_code&quot;: 200
}
</code></pre>
<p>Possible roles are:</p>
<ul>
<li>global superuser (superuser)</li>
<li>global moderator (globalmod)</li>
<li>channel owner (owner)</li>
<li>channel admin (admin)</li>
<li>room owner (owner)</li>
<li>room moderator (moderator)</li>
</ul>
<p>The only difference between global superusers and global moderators is that global superusers can also remove static 
rooms.</p>
<h2 id="get-count-joins">GET count-joins</h2>
<p>Count the cumulative number of joins for a room. Used for counting the number of "views" a live stream has had. The 
count is cached for 8 hours, then fetched from db if requested again.</p>
<p>Using curl:</p>
<pre><code class="language-sh">curl localhost:7300/count-joins -X GET -H 'Content-Type: application/json' -d @- &lt;&lt; EOF
{
    &quot;room_ids&quot;: [&quot;2e7d537e-bed5-47c5-a7f6-357075759e5d&quot;]
}
EOF
</code></pre>
<p>Instead of <code>room_ids</code>, we can use <code>room_names</code> (base64 encoded) instead (only works for rooms in the default channel, 
e.g. created using <code>POST /create</code>):</p>
<pre><code class="language-sh">curl localhost:7300/count-joins -X GET -H 'Content-Type: application/json' -d @- &lt;&lt; EOF
{
    &quot;room_names&quot;: [&quot;c29tZSByb29tIG5hbWUK&quot;]
}
EOF
</code></pre>
<p>If room IDs were used in the request, the keys in the response will also be room IDs, but if room names were used, 
the base64 encoded room name will be the key:</p>
<pre><code class="language-json">{
  &quot;status_code&quot;: 200, 
  &quot;data&quot;: {
    &quot;2e7d537e-bed5-47c5-a7f6-357075759e5d&quot;: 5,
    &quot;0e88aae3-cb2f-457c-b1be-8e882479bd34&quot;: 3290,
    &quot;0c289aaf-3c7b-4290-89bb-e1fa27cd2300&quot;: 89
  }
}
</code></pre>
<h2 id="get-users-in-rooms">GET users-in-rooms</h2>
<p>Request contains a list of room IDs, and an optional <code>only_count</code> field (default is <code>false</code>), e.g.:</p>
<pre><code class="language-json">{
    &quot;room_ids&quot;: [
        &quot;2ddd90ac-1d44-4af5-9c7d-b9191bc35675&quot;,
        &quot;2e7d537e-bed5-47c5-a7f6-357075759e5d&quot;
    ],
    &quot;only_count&quot;: false
}
</code></pre>
<p>Instead of room IDs, we can specify room names (base64 encoded):</p>
<pre><code class="language-json">{
    &quot;room_names&quot;: [
        &quot;c29tZSByb29tIG5hbWUK&quot;
    ]
}
</code></pre>
<p>Response would be all visible users in the specified rooms, with their user infos attached (<code>roles</code> is a 
comma-separated list of roles, e.g. <code>owner,globalmod</code>).</p>
<p>If room IDs were used in the request, the keys in the response will also be room IDs, but if room names were used, 
the base64 encoded room name will be the key:</p>
<pre><code class="language-json">{
    &quot;data&quot;: {
        &quot;2ddd90ac-1d44-4af5-9c7d-b9191bc35675&quot;: [{
            &quot;id&quot;: &quot;898121&quot;,
            &quot;info&quot;: {
                &quot;membership&quot;: &quot;MA==&quot;,
                &quot;has_webcam&quot;: &quot;eQ==&quot;,
                &quot;age&quot;: &quot;OTk=&quot;,
                &quot;is_streaming&quot;: &quot;RmFsc2U=&quot;,
                &quot;city&quot;: &quot;U2FzZGY=&quot;,
                &quot;fake_checked&quot;: &quot;eQ==&quot;,
                &quot;country&quot;: &quot;Y24=&quot;,
                &quot;gender&quot;: &quot;bQ==&quot;,
                &quot;image&quot;: &quot;eQ==&quot;
            },
            &quot;roles&quot;: &quot;owner&quot;,
            &quot;name&quot;: &quot;Um9iYnk=&quot;
        }],
        &quot;2e7d537e-bed5-47c5-a7f6-357075759e5d&quot;: []
    },
    &quot;status_code&quot;: 200
}
</code></pre>
<p>Response if <code>only_count</code> is <code>true</code>:</p>
<pre><code class="language-json">{
    &quot;data&quot;: {
        &quot;2ddd90ac-1d44-4af5-9c7d-b9191bc35675&quot;: 5,
        &quot;2e7d537e-bed5-47c5-a7f6-357075759e5d&quot;: 2
    },
    &quot;status_code&quot;: 200
}
</code></pre>
<h2 id="post-create">POST create</h2>
<p>Creates and joins the room (if specified users are online). Rooms created using this API will always be in the default
channel.</p>
<p>Example request:</p>
<pre><code class="language-json">{
    &quot;user_ids&quot;: [
        &quot;1234&quot;,
        &quot;5678&quot;
    ],
    &quot;room_name&quot;: &quot;&lt;a room name, in base64&gt;&quot;,
    &quot;owner_id&quot;: &quot;&lt;a user id&gt;&quot;,
    &quot;owner_name&quot;: &quot;&lt;a user name, in base64&gt;&quot;
}
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200,
    &quot;data&quot;: {
        &quot;room_id&quot;: &quot;01eafcf0-4ab2-48bb-8ff5-833b056d2727&quot;,
        &quot;room_name&quot;: &quot;tr19&quot;,
        &quot;channel_id&quot;: &quot;8d43181a-13e0-4ccc-a64b-ae8e93d36bcd&quot;,
        &quot;user_ids_not_joined&quot;: [&quot;1234&quot;]
    }
}
</code></pre>
<p>If some users could not be made to join the newly created room, because they're offline, their IDs will be returned in
the <code>user_ids_not_joined</code> list.</p>
<h2 id="post-join">POST join</h2>
<p>Joins the room (if specified users are online). Only works for rooms in the default channel (e.g. 
rooms created using the <code>POST /create</code> API).</p>
<p>If <code>room_id</code> is specified, it will be used, otherwise, the <code>room_name</code> will be used to lookup the 
correct room in the default channel.</p>
<p>Example request:</p>
<pre><code class="language-json">{
    &quot;user_ids&quot;: [
        &quot;1234&quot;,
        &quot;5678&quot;
    ],
    &quot;room_id&quot;: &quot;&lt;optional: a room id&gt;&quot;,
    &quot;room_name&quot;: &quot;&lt;a room name, in base64&gt;&quot;
}
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200,
    &quot;data&quot;: {
        &quot;success&quot;: 1,
        &quot;failures&quot;: 0,
        &quot;errors&quot;: []
    }
}
</code></pre>
<p>If the room does not exist, error code <code>802</code> will be returned:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200,
    &quot;data&quot;: {
        &quot;success&quot;: 0,
        &quot;failures&quot;: 1,
        &quot;errors&quot;: [{
            &quot;status_code&quot;: 802,
            &quot;error&quot;: &quot;no room exists with id 01eafcf0-4ab2-48bb-8ff5-833b056d2727 or name &lt;some name&gt;&quot;
        }]
    }
}
</code></pre>
<p>If the user does not exist (i.e. the user is not online), error code <code>800</code> will be returned:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200,
    &quot;data&quot;: {
        &quot;success&quot;: 0,
        &quot;failures&quot;: 1,
        &quot;errors&quot;: [{
            &quot;status_code&quot;: 800,
            &quot;error&quot;: &quot;user not online: 1234&quot;
        }]
    }
}
</code></pre>
<p>If a user in the <code>user_ids</code> list is banned from joining the room (or the channel, or globally), error <code>703</code> will be 
returned for that user:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200,
    &quot;data&quot;: {
        &quot;success&quot;: 0,
        &quot;failures&quot;: 1,
        &quot;errors&quot;: [{
            &quot;status_code&quot;: 703,
            &quot;error&quot;: &quot;user 1234 is banned from room/channel/global &lt;some name&gt; for 3601 seconds. Reason: &lt;some reason specified when the user was banned&gt;&quot;
        }]
    }
}
</code></pre>
<h2 id="post-leave">POST leave</h2>
<p>Leaves the room (if specified users are online). Only works for rooms in the default channel (e.g. 
rooms created using the <code>POST /create</code> API).</p>
<p>If <code>room_id</code> is specified, it will be used, otherwise, the <code>room_name</code> will be used to lookup the 
correct room in the default channel.</p>
<p>Example request:</p>
<pre><code class="language-json">{
    &quot;user_ids&quot;: [
        &quot;1234&quot;,
        &quot;5678&quot;
    ],
    &quot;room_id&quot;: &quot;&lt;optional: a room id&gt;&quot;,
    &quot;room_name&quot;: &quot;&lt;a room name, in base64&gt;&quot;
}
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200
}
</code></pre>
<h2 id="get-rooms-for-users">GET rooms-for-users</h2>
<p>Request contains a list of user IDs, e.g.:</p>
<pre><code class="language-json">{
    &quot;users&quot;: [
        &quot;1234&quot;,
        &quot;5678&quot;
    ]
}
</code></pre>
<p>Response would be all rooms each user is currently in (room names and channel names are base64 encoded):</p>
<pre><code class="language-json">{
    &quot;1234&quot;: [{
        &quot;room_id&quot;: &quot;efeca2fe-ba93-11e6-bc9a-4f6f56293063&quot;,
        &quot;room_name&quot;: &quot;b2gsIHNvIHlvdSBhY3R1YWxseSBjaGVja2VkIHdoYXQgaXMgd2FzPw==&quot;,
        &quot;channel_id&quot;: &quot;fb843140-ba93-11e6-b178-97f0297a6d4d&quot;,
        &quot;channel_name&quot;: &quot;dG9tIGlzIGEgZnJlbmNoIG1hZG1hbg==&quot;
    }],
    &quot;5678&quot;: [{
        &quot;room_id&quot;: &quot;ca1dc3b4-ba93-11e6-b835-7f1d961023a1&quot;,
        &quot;room_name&quot;: &quot;cmVhZCB1cCBvbiBoeXBlcmxvZ2xvZysr&quot;,
        &quot;channel_id&quot;: &quot;f621fcaa-ba93-11e6-8590-bfe35ff80c03&quot;,
        &quot;channel_name&quot;: &quot;YSByZWRidWxsIGEgZGF5IGtlZXBzIHRoZSBzYW5kbWFuIGF3YXk=&quot;
    }]
}
</code></pre>
<h2 id="post-delete-messages">POST delete-messages</h2>
<p>Used to delete ALL messages for a specific user ID.</p>
<p>Request body looks like this:</p>
<pre><code class="language-json">{
    &quot;id&quot;: &quot;&lt;user ID&gt;&quot;
}
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200, 
    &quot;data&quot;: {
        &quot;success&quot;: 4, 
        &quot;failed&quot;: 0,
        &quot;total&quot;: 4
    }
}
</code></pre>
<p>Or if other kinds of failures:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 500, 
    &quot;data&quot;: &quot;&lt;error message, e.g. 'no id parameter in request'&gt;&quot;
}
</code></pre>
<h2 id="get-banned">GET banned</h2>
<p>If no request data is sent, the response is all banned users, separated by channel, room and globally. Example response:</p>
<pre><code class="language-json">{
  &quot;status_code&quot;: 200,
  &quot;data&quot;: {
    &quot;channels&quot;: {},
    &quot;global&quot;: {
      &quot;185626&quot;: {
        &quot;name&quot;: &quot;bHVlbA==&quot;,
        &quot;duration&quot;: &quot;1h&quot;,
        &quot;timestamp&quot;: &quot;2016-12-05T03:50:24Z&quot;
      }
    },
    &quot;rooms&quot;: {
      &quot;1aa3f5f5-ba46-4aca-999a-978c7f2237c7&quot;: {
        &quot;name&quot;: &quot;Y29vbCBndXlz&quot;,
        &quot;users&quot;: {
          &quot;101108&quot;: {
            &quot;name&quot;: &quot;bHVlbA==&quot;,
            &quot;duration&quot;: &quot;30m&quot;,
            &quot;timestamp&quot;: &quot;2016-12-05T03:20:24Z&quot;
          }
        }
      }
    }
  }
}
</code></pre>
<p>The <code>timestamp</code> in the response is the UTC timestamp for when the ban will expire. Names or channels, rooms and users
are all base64 encoded. The dictionary keys for <code>rooms</code> are the UUIDs of the rooms, same for channels, while for users
it's their user IDs as keys. The bans for <code>global</code> have no separation by room/channel IDs, and no "name" or "users" 
keys.</p>
<p>If <code>room_id</code> is specified in the request, the response will only contain bans for that room. If <code>channel_id</code> is 
specified, the response will only contain bans for that channel. Example request for bans in a certain room:</p>
<pre><code class="language-json">{
    &quot;room_id&quot;: &quot;1aa3f5f5-ba46-4aca-999a-978c7f2237c7&quot;
}
</code></pre>
<p>Then the response would be (the key is the user ID; same format if <code>room_name</code> in base64 is used instead of <code>room_id</code>):</p>
<pre><code class="language-json">{
  &quot;status_code&quot;: 200,
  &quot;data&quot;: {
    &quot;1234&quot;: {
        &quot;name&quot;: &quot;&lt;username in base64&gt;&quot;,
        &quot;duration&quot;: &quot;&lt;seconds left until the ban is lifted&gt;&quot;,
        &quot;reason&quot;: &quot;&lt;ban reason in base64&gt;&quot;,
        &quot;timestamp&quot;: &quot;2016-12-05T03:20:24Z&quot;
    },
    &quot;5678&quot;: {
        &quot;name&quot;: &quot;&lt;username in base64&gt;&quot;,
        &quot;duration&quot;: &quot;&lt;seconds left until the ban is lifted&gt;&quot;,
        &quot;reason&quot;: &quot;&lt;ban reason in base64&gt;&quot;,
        &quot;timestamp&quot;: &quot;2016-12-05T03:20:24Z&quot;
    }
  }
}
</code></pre>
<p>If only global bans are needed, use the <code>global</code> key, and no other keys. Example request:</p>
<pre><code class="language-json">{
    &quot;global&quot;: true
}
</code></pre>
<p>Response is in the same format as above.</p>
<p>If the room doesn't exist, error <code>802</code> is returned:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200,
    &quot;data&quot;: {
        &quot;code&quot;: 802,
        &quot;message&quot;: &quot;no room exists with name &lt;room name&gt;&quot;
    }
}
</code></pre>
<h2 id="post-status">POST status</h2>
<p>Set the online status or visibility status of a user.</p>
<p>Request contains:</p>
<pre><code class="language-json">{   
    &quot;id&quot;: &quot;&lt;user ID&gt;&quot;,
    &quot;status&quot;: &quot;&lt;one of online/offline/invisible/visible&gt;&quot;,
    &quot;stage&quot;: &quot;&lt;one of login/status&gt;&quot;
}   
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200
}
</code></pre>
<h2 id="post-send">POST send</h2>
<p>If <code>target_id</code> is not specified in the request body, but <code>target_name</code> is, Dino will try to 
send the message to the room with that name, but it only works for rooms that are in the 
default channel (rooms created using <code>POST /create</code> are always in the default channel).</p>
<p>The <code>target_name</code> field (if specified), must be base64 encoded.</p>
<p>The <code>persist</code> parameter is by default <code>false</code>, so if you need to be able to query the history
all <code>/send</code> requests needs to have <code>"persist": true</code>.</p>
<p>Request contains:</p>
<pre><code class="language-json">{   
    &quot;user_id&quot;: &quot;&lt;user ID&gt;&quot;,
    &quot;user_name&quot;: &quot;&lt;username, in base64&gt;&quot;,
    &quot;object_type&quot;: &quot;&lt;room/private&gt;&quot;,
    &quot;target_id&quot;: &quot;&lt;user ID to send to or UUID of room to send to&gt;&quot;,
    &quot;target_name&quot;: &quot;&lt;the name of the user/room to send to, in base64&gt;&quot;,
    &quot;content&quot;: &quot;&lt;the body to send, in base64&gt;&quot;,
    &quot;persist&quot;: false
}   
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
    &quot;status_code&quot;: 200
}
</code></pre>
<p>User/room will get something similar to this in a <code>message</code> event:</p>
<pre><code class="language-json">{
    &quot;id&quot;: &quot;1d805e18-a773-11e8-a65f-8b33c55c9e1b&quot;,
    &quot;published&quot;: &quot;2017-01-26T04:58:31Z&quot;,
    &quot;actor&quot;: {
        &quot;id&quot;: &quot;&lt;user ID&gt;&quot;,
        &quot;displayName&quot;: &quot;&lt;username, in base64&gt;&quot;
    },
    &quot;verb&quot;: &quot;send&quot;,
    &quot;target&quot;: {
        &quot;objectType&quot;: &quot;&lt;room/private&gt;&quot;,
        &quot;id&quot;: &quot;&lt;user ID to send to or UUID of room to send to&gt;&quot;,
        &quot;displayName&quot;: &quot;&lt;the name of the user/room to send to, in base64&gt;&quot;
    },
    &quot;object&quot;: {
        &quot;id&quot;: &quot;&lt;uuid of the message IF persist=true&gt;&quot;,
        &quot;content&quot;: &quot;&lt;the body to send, in base64&gt;&quot;
    }
}
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../wio/" class="btn btn-neutral float-right" title="Who Is Online?">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../acl/" class="btn btn-neutral" title="ACL"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../acl/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../wio/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
